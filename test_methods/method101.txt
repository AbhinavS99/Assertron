[[[/**
 * 数据源开启kerberos时 如果这里不通过反射对 writerOptions 赋值fs，则在recordWriter.writer时 会初始化一个fs 此fs不在ugi里获取的
 * 导致开启了kerberos的数据源在checkpoint时进行 recordWriter.close() 操作，会出现kerberos认证错误
 */
private void setFs() throws IllegalAccessException {
    if (Hive3Util.isOpenKerberos(hdfsConfig.getHadoopConfig())) {
        Field declaredField = ReflectionUtils.getDeclaredField(recordWriter, "options");
        assert declaredField != null;
        declaredField.setAccessible(true);
        OrcFile.WriterOptions writerOptions = (OrcFile.WriterOptions) declaredField.get(recordWriter);
        writerOptions.fileSystem(fs);
        declaredField.setAccessible(false);
    }
}]]],