[[[@Override
public MetadataConnection<MongoDbConnection> getConnection(String operator, Map<String, Object> params) throws Exception {
    String host = String.valueOf(params.getOrDefault(MongoDbParamsMapper.PARAM_MONGO_HOST.getValue(), ""));
    // After deserialize, Integer will be Double, Why?
    Integer port = (Double.valueOf(String.valueOf(params.getOrDefault(MongoDbParamsMapper.PARAM_MONGO_PORT.getValue(), 0)))).intValue();
    String username = String.valueOf(params.getOrDefault(MongoDbParamsMapper.PARAM_MONGO_USERNAME.getValue(), ""));
    String password = String.valueOf(params.getOrDefault(MongoDbParamsMapper.PARAM_MONGO_PASSWORD.getValue(), ""));
    String database = String.valueOf(params.getOrDefault(MongoDbParamsMapper.PARAM_MONGO_DATABASE.getValue(), ""));
    Map<String, Object> extraParams = new HashMap<>();
    Object sqlParamObj = params.get(MongoDbParamsMapper.PARAM_MONGO_EXTRA_PARAMS.getValue());
    if (null != sqlParamObj) {
        if (!(sqlParamObj instanceof Map)) {
            String paramStr = String.valueOf(sqlParamObj);
            if (StringUtils.isNotBlank(paramStr)) {
                extraParams = Json.fromJson(paramStr, Map.class, String.class, Object.class);
            }
        } else {
            extraParams = (Map<String, Object>) sqlParamObj;
        }
    }
    assert extraParams != null;
    return new MetadataConnection<>(new MongoDbConnection(host, port, username, password, database, extraParams));
}]]],