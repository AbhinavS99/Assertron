[[[@Override
public Frame convert(Bitmap bitmap) {
    if (bitmap == null) {
        return null;
    }
    int channels = 0;
    switch(bitmap.getConfig()) {
        case ALPHA_8:
            channels = 1;
            break;
        case RGB_565:
        case ARGB_4444:
            channels = 2;
            break;
        case ARGB_8888:
            channels = 4;
            break;
        default:
            assert false;
    }
    if (frame == null || frame.imageWidth != bitmap.getWidth() || frame.imageStride != bitmap.getRowBytes() || frame.imageHeight != bitmap.getHeight() || frame.imageChannels != channels) {
        if (frame != null) {
            frame.close();
        }
        frame = new Frame(bitmap.getWidth(), bitmap.getHeight(), Frame.DEPTH_UBYTE, channels, bitmap.getRowBytes());
    }
    bitmap.copyPixelsToBuffer(frame.image[0].position(0));
    return frame;
}]]],